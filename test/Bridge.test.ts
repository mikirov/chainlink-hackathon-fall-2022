import { ethers, upgrades } from "hardhat";
import { Signer } from "ethers";
import { assert, expect } from "chai";
import { RootTunnel } from "../typechain-types";
describe.only("Bridge", function () {
  let ethereumSigner: Signer;

  let rootTunnel: RootTunnel;
  this.timeout(100_000_000)
  this.beforeEach(async function () {
    const [ethereumSigner] = await ethers.getSigners();

    const rootTunnelFactory = await ethers.getContractFactory(
      "RootTunnel",
      ethereumSigner
    );
    rootTunnel = await rootTunnelFactory.deploy({ gasLimit: 10_000_000 });
    await rootTunnel.deployed();
    console.log("RootTunnel deployed to:", rootTunnel.address);

    await rootTunnel.setFxChildTunnel(
      "0xB68B86C1D26d8B11fd85A732A0B129233b3fbD40"
    );
  });

  it("should execute receive message successfully", async function () {
    await expect(
      rootTunnel.receiveMessage(
        "0xf90c5d842fd2bca0b901407f2ebc328cfc8e6503e88f93783a1692ed7fec19ae111cf1b56614003d641fbef3cd9cbd98d189f8e522fda1ff65972175bcc7cfb393064d42baba2b19d7124b22c38900b23cf55d82d16096de15e4a247e7a0fc36f213dee6955b174f22347e78d3e3eef11a736bf98b5658341396e56f176f77a5110acb521ad2b5ce3fd0605d34a073c2b5faf002465bed36643051bc7902c6af7bafc29b3577e02c00ca40aa61839a3d425009d2295aa17ba261efc0b639a6f0535ae026a80e7a3b536df3f2cf1f39e0e0bb5bcd5214314af5add51a70b28b0725a09a7ea4a379d7b6825febc08f3ad3489331f37dd7f45d8863e77583c6b411269ab810d385f15aec5487fe252ad01b2f38155c4c33240bcbdbb16860f73a53f9d271f2df8f9159de3128025581ee33bee4ecc44ba9476ab24c6f9cefc2408b4a89a18b14c96abae9df938401bcc449846372394aa090352911451a29abfd149ea375217f831f8aa67a26747a712d051937f51d9ca4a04e3f434e8da24702e5a3a8a5c6ba408b3a8279c3edaad712c55ff7dfe852486bb9052102f9051d0183014ebab9010000040000004000020000000000000000000000000000000000000008000000000040000000000200000000000000000100008000000000000000000000200000000000100000000000000008000200800000000000000000000100000000000000000000000000000000000000400000002000000040000080010010000000000000000000008000000000000400000000000000000000000000000000000000220000000000000020000000000000000001020000000000000000000000004000000002000000000401000000000000000000000000000000100000000000080010000000000000800000000000000000000000000000000000000000100000f90412f89b94565a39628964995f1d74502d03838b42e280b18bf863a08c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925a0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da00000000000000000000000000000000000000000000000000000000000000000f89b94565a39628964995f1d74502d03838b42e280b18bf863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da00000000000000000000000000000000000000000000000056bc75e2d63100000f89b94565a39628964995f1d74502d03838b42e280b18bf863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da0000000000000000000000000cecd44e90b839f2584d1a7f9509b196e94bd4acea00000000000000000000000000000000000000000000000056bc75e2d63100000f8f994b68b86c1d26d8b11fd85a732a0b129233b3fbd40e1a08c5261668696ce22758910d05bab8f186d6eb247ceac2af2e82c7dc17669b036b8c0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000649f92a13f000000000000000000000000011c1b8a25e4f309e78f717cf021939c4b5f2e6f000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f5670000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a0000000000000000000000000c26880a0af2ea0c7e8130e6ec47af756465452e8b8a00000000000000000000000000000000000000000000000000000c2d62506ea000000000000000000000000000000000000000000000000001a6df98fa6001fb900000000000000000000000000000000000000000000178aa6033da90283acd50000000000000000000000000000000000000000000000001a6d36b980f935b900000000000000000000000000000000000000000000178aa604007f278a96d5b9059ef9059bf871a0376fa592342d25cd8b8b31ac580e2912fe5bee09680830c8a9b55ba4cd04f3b0a08de4040e08e77d980bccc3d60de5c19486572bc4696d360c523a747c383342f8808080808080a0aa85f8d9af7be0c2183da0f5eb6b80d4b44709d9aa84c6a76fb5da18e8edf4208080808080808080f9052530b9052102f9051d0183014ebab9010000040000004000020000000000000000000000000000000000000008000000000040000000000200000000000000000100008000000000000000000000200000000000100000000000000008000200800000000000000000000100000000000000000000000000000000000000400000002000000040000080010010000000000000000000008000000000000400000000000000000000000000000000000000220000000000000020000000000000000001020000000000000000000000004000000002000000000401000000000000000000000000000000100000000000080010000000000000800000000000000000000000000000000000000000100000f90412f89b94565a39628964995f1d74502d03838b42e280b18bf863a08c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925a0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da00000000000000000000000000000000000000000000000000000000000000000f89b94565a39628964995f1d74502d03838b42e280b18bf863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da00000000000000000000000000000000000000000000000056bc75e2d63100000f89b94565a39628964995f1d74502d03838b42e280b18bf863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa000000000000000000000000025dd824e6b303b7905c89518c6fce1a09864c56da0000000000000000000000000cecd44e90b839f2584d1a7f9509b196e94bd4acea00000000000000000000000000000000000000000000000056bc75e2d63100000f8f994b68b86c1d26d8b11fd85a732a0b129233b3fbd40e1a08c5261668696ce22758910d05bab8f186d6eb247ceac2af2e82c7dc17669b036b8c0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000649f92a13f000000000000000000000000011c1b8a25e4f309e78f717cf021939c4b5f2e6f000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f5670000000000000000000000000000000000000000000000056bc75e2d6310000000000000000000000000000000000000000000000000000000000000f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000f52b7eba863ee3378cc9dd60efd62df1bb08f567a0000000000000000000000000c26880a0af2ea0c7e8130e6ec47af756465452e8b8a00000000000000000000000000000000000000000000000000000c2d62506ea000000000000000000000000000000000000000000000000001a6df98fa6001fb900000000000000000000000000000000000000000000178aa6033da90283acd50000000000000000000000000000000000000000000000001a6d36b980f935b900000000000000000000000000000000000000000000178aa604007f278a96d582008003"
      )
    ).to.not.be.reverted;
    console.log(await rootTunnel.latestData());
  });
});
